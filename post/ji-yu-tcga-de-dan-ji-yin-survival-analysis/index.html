
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>基于TCGA的单基因survival analysis | Gridea</title>
<meta name="description" content="温故而知新">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://ninjagg.github.io/Xuan.github.io//favicon.ico?v=1621940078479">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://ninjagg.github.io/Xuan.github.io//styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://ninjagg.github.io/Xuan.github.io/">
        <img class="avatar" src="https://ninjagg.github.io/Xuan.github.io//images/avatar.png?v=1621940078479" alt="" width="32px" height="32px">
      </a>
      <a href="https://ninjagg.github.io/Xuan.github.io/">
        <h1 class="site-title">Gridea</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            首页
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            标签
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            关于
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
          <h2 class="post-title">基于TCGA的单基因survival analysis</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2021-03-18</span>
            
          </div>
          <div class="post-content">
            <h1 id="一确定基因名字">一：确定基因名字</h1>
<p>基因的名字很多，登录<a href="https://ninjagg.github.io/Xuan.github.io//post-images/1616070388162.png">Uniprot</a></p>
<h1 id="二疾病">二：疾病</h1>
<p>以结直肠癌为例</p>
<h1 id="三tcga基因表达以及临床生存信息下载">三：TCGA&quot;基因表达&quot;以及&quot;临床生存信息&quot;下载：</h1>
<p><a href="https://xenabrowser.net/datapages/">UCSC Xena</a><br>
<img src="https://ninjagg.github.io/Xuan.github.io//post-images/1616071647107.png" alt="" loading="lazy"><br>
&quot;基因表达&quot;数据下载：<br>
<img src="https://ninjagg.github.io/Xuan.github.io//post-images/1616071773525.png" alt="" loading="lazy"><br>
<img src="https://ninjagg.github.io/Xuan.github.io//post-images/1616071809308.png" alt="" loading="lazy"><br>
&quot;临床生存信息&quot;下载：<br>
<img src="https://ninjagg.github.io/Xuan.github.io//post-images/1616071883082.png" alt="" loading="lazy"><br>
下载后放到R的工作目录中即可</p>
<h1 id="四r代码survival-analysis">四：R代码survival analysis</h1>
<pre><code>rm(list = ls())

####load package####
library(tidyverse)

####读取数据####
gene_exp &lt;- read.table(file = &quot;./TCGA.COAD.sampleMap%2FHiSeqV2&quot;, header = T, sep = &quot;\t&quot;)

####gene_expression数据清洗####
rownames(gene_exp) &lt;- gene_exp[ ,1] #第一列是Sample，将第一列作为行名
gene_exp &lt;- gene_exp[ ,-1] #删掉原本第一列Sample的数据

####得到基因KIAA1324在各个样本中的表达数据####
GENE &lt;- as.data.frame(t(gene_exp)) #t()转置之后是matrix 需要转换
temp &lt;- rownames(GENE) == &quot;KIAA1324&quot; #筛选，基因的名字(Gene names)都试一试
GENE2 &lt;- GENE[temp, ]
GENE &lt;- GENE2 #防止变量弄混
GENE &lt;- as.data.frame(t(GENE)) #让&quot;临床分组&quot;变为观测，&quot;基因名&quot;为变量

####计算基因&quot;KIAA1324&quot;表达量中位数####
med &lt;- median(GENE$KIAA1324)

####筛选基因高低表达####
high &lt;- GENE$KIAA1324 &gt; med
low &lt;- GENE$KIAA1324 &lt;= med
GENE[high, ] &lt;- &quot;High&quot;
GENE[low, ] &lt;- &quot;Low&quot;

####获取临床####
clinical &lt;- read.table(file = &quot;./survival%2FCOAD_survival.txt&quot;, header = T, sep = &quot;\t&quot;)

####clinical数据清洗####
clinical_clean &lt;- data.frame(gsub(&quot;-&quot;, &quot;.&quot;, clinical$Sample), clinical) #将行名中连接的&quot;-&quot;换为&quot;.&quot;
colnames(clinical_clean[1]) &lt;- &quot;SampleID&quot; #修改列&quot;名字&quot;
clinical_clean_2 &lt;- clinical_clean[ ,-2] #删除原列&quot;名字&quot;

####合并基因表达及临床数据####
gene_clinical &lt;- data.frame(clinical_clean_2[match(rownames(GENE), clinical_clean_2$SampleID), ], GENE)

####&quot;KIAA1324&quot;低表达为1，高表达为2####
gene_clinical$KIAA1324 &lt;- ifelse((gene_clinical$KIAA1324 == &quot;Low&quot;), 1, 2)
GC &lt;- gene_clinical

##################生存分析作图 OS作图####
library(survival)
fit.surv &lt;- Surv(GC$OS.time, GC$OS)
km &lt;- survfit(fit.surv~1, data = GC)
km_2 &lt;- survfit(fit.surv~KIAA1324, data = GC)

library(survminer)
ggsurvplot(km_2,
legend.title = &quot;KIAA1324&quot;, #改变图例名称
legend.labs = c(&quot;High&quot;, Low&quot;),
pval = T #显示P值
)

##################生存分析作图 OS作图####
library(survival)
fit.surv &lt;- Surv(GC$PFI.time, GC$PFI)
km &lt;- survfit(fit.surv~1, data = GC)
km_2 &lt;- survfit(fit.surv~KIAA1324, data = GC)

library(survminer)
ggsurvplot(km_2,
legend.title = &quot;KIAA1324&quot;, #改变图例名称
legend.labs = c(&quot;High&quot;, &quot;Low&quot;),
pval = T #显示P值
)
</code></pre>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://ninjagg.github.io/Xuan.github.io/post/mac-shang-an-zhuang-aspera-bu-zou/">
              <h3 class="post-title">
                下一篇：Mac上安装Aspera步骤
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">温故而知新</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://ninjagg.github.io/Xuan.github.io//atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
